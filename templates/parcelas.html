{% extends "base.html" %}
{% block content %}
<h5 class="mb-3">Parcelas - Contrato {{ contrato.contrato or contrato.id }}</h5>

<div class="row g-2 mb-3">
  {% set cards = [
    ('Valor', resumo.valor),
    ('Valor pago', resumo.valor_pago),
    ('Valor abatido', resumo.valor_abatido),
    ('Custas', resumo.custas),
    ('Custas deduzida', resumo.custas_deduzida),
    ('Protesto', resumo.protesto),
    ('Protesto deduzido', resumo.protesto_deduzido),
    ('Honor치rio', resumo.honorario),
    ('Honor치rio repassado', resumo.honorario_repassado),
    ('Alvar치', resumo.alvara),
    ('Alvar치 recebido', resumo.alvara_recebido),
    ('Ganho', resumo.ganho),
  ] %}
  {% for titulo, val in cards %}
  <div class="col-md-3">
    <div class="card card-resumo">
      <div class="card-body py-2">
        <div class="card-title">{{ titulo }}</div>
        <div class="valor">R$ {{ val|brl }}</div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<table class="table table-sm bg-white">
  <thead class="table-light">
    <tr>
      <th style="width: 50px;">#</th>
      <th>Vencimento</th>
      <th>Valor</th>
      <th>Baixa</th>
    </tr>
  </thead>
  <tbody>
    {% for p in parcels %}
    <tr>
      <td>{{ p.numero }}</td>
      <td>{{ p.vencimento|data }}</td>
      <td>R$ {{ p.valor|brl }}</td>
      <td>
        {% if p.baixado_em %}
          <span class="text-success">Baixada em {{ p.baixado_em|data }}</span>
        {% else %}
          <form action="{{ url_for('baixar_parcela', cid=contrato.id, pid=p.id) }}" method="post">
            <button class="btn btn-primary btn-sm">Dar Baixa</button>
          </form>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<a href="{{ url_for('index') }}" class="btn btn-outline-secondary btn-sm">Voltar</a>
{% endblock %}
